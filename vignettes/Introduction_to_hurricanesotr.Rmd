---
title: "Introduction_to_hurricanesotr"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Introduction_to_hurricanesotr}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(hurricanesotr)
```


The goal of hurricanesotr is to provide tools to manipulate  hurricanes data. If given a database of recorded hurricanes, the hurricanesotr package helps produce a single 
observation time dataset for any single storm in the database. It is done by supplying to 
sotdfss function the following arguments: name, year, month, day and hour. 
The default database for storms is ext_tracks. A data downloaded from 
 \url{http://rammb.cira.colostate.edu/research/tropical_cyclones/tc_extended_best_track_dataset/} and cleaned by a code provided in data-raw. 
 wborder and wborders are the main functions called by StatHurricane to transform the data.
 stat_hurricane and geom_hurricane help plot the wind radii for single observation time dataset as polygons


## Installation

You can install the development version of hurricanesotr like so:

``` r
install.packages("devtools")
library(devtools)
devtools::install_github("hugo7gpad/hurricanesotr")
`
## Examples

This is a basic example which shows you how to get the single observation time dataset
for the storm KATRINA on August 29, 2005 at 12pm

```{r example1}
library(hurricanesotr)
data("ext_tracks")
katrina <- sotdfss("KATRINA", 2005, "08", "29", "12")
head(katrina)
```

We can now plot the wind radii the single observation time of the hurricane KATRINA using geom_hurricane():

```{r example2}
ggplot2::ggplot(data = katrina) +
  geom_hurricane(ggplot2::aes(x = longitude, y = latitude, r_ne = ne, r_nw = nw, r_sw = sw,
                              r_se = se, fill = wind_speed, colour = wind_speed),
                 scale_radii = 1, np = 250) +
  ggplot2::scale_colour_manual(name = "Wind speed (kts)", values = c("red", "orange", "yellow")) +
  ggplot2::scale_fill_manual(name = "Wind speed (kts)", values = c("red", "orange", "yellow"))
```

Let's add this wind radii to a base map of Louisiana

```{r example3}
library(ggmap)
map_data <- ggmap::get_map("Louisiana", zoom = 6, maptype = "toner-background")
base_map <- ggmap::ggmap(map_data, extent = "device")

base_map +
  geom_hurricane(data = katrina, ggplot2::aes(x = longitude, y = latitude, r_ne = ne, r_nw = nw,                                                  r_sw = sw, r_se = se, fill = wind_speed,
                                              colour = wind_speed), scale_radii = 1, np = 250) +
  ggplot2::scale_colour_manual(name = "Wind speed (kts)", values = c("red", "orange", 'yellow')) +
  ggplot2::scale_fill_manual(name = "Wind speed (kts)", values = c("red", "orange", 'yellow'))
```

Now, we can you use the scale_radii parameter to plot the wind radii only at 50%

```{r example4}
 library(gridExtra)
# Default: scale_radii = 1
defaultScaleRadii_1 <- base_map +
  geom_hurricane(data = katrina, ggplot2::aes(x = longitude, y = latitude, r_ne = ne, r_nw = nw,                                                  r_sw = sw, r_se = se, fill = wind_speed,
                                              colour = wind_speed), scale_radii = 1, np = 250) +
  ggplot2::scale_colour_manual(name = "Wind speed (kts)", values = c("red", "orange", 'yellow')) +
  ggplot2::scale_fill_manual(name = "Wind speed (kts)", values = c("red", "orange", 'yellow')) +
  labs(title = "scale_radii = 1")

# scale_radii = 0.5
scaleRadii_0.5 <- base_map +
  geom_hurricane(data = katrina, ggplot2::aes(x = longitude, y = latitude, r_ne = ne, r_nw = nw,                                                  r_sw = sw, r_se = se, fill = wind_speed,
                                              colour = wind_speed), scale_radii = 0.5, np = 250) +
  ggplot2::scale_colour_manual(name = "Wind speed (kts)", values = c("red", "orange", 'yellow')) +
  ggplot2::scale_fill_manual(name = "Wind speed (kts)", values = c("red", "orange", 'yellow')) +
  labs(title = "scale_radii = 0.5")

gridExtra::grid.arrange(defaultScaleRadii_1, scaleRadii_0.5, ncol = 2)

```


We can also change the number of points on each section of the plots with the parameter np.
By default it is 250. Let's reduce it to 100. It does not make a noticeable change on the plot

```{r example5}
ggplot2::ggplot(data = katrina) +
  geom_hurricane(ggplot2::aes(x = longitude, y = latitude, r_ne = ne, r_nw = nw, r_sw = sw,
                              r_se = se, fill = wind_speed, colour = wind_speed),
                 scale_radii = 1, np = 100) +
  ggplot2::scale_colour_manual(name = "Wind speed (kts)", values = c("red", "orange", 'yellow')) +
  ggplot2::scale_fill_manual(name = "Wind speed (kts)", values = c("red", "orange", 'yellow'))
```

